# Криптографический протокол электронных голосований

Пусть стоит задача провести голосование в электронном виде и организаторы данного мероприятия хотят максимально обезопасить все этапы:
1. Передача голосов от избирателя к Центру.
2. Подсчет голосов
3. Проверка правильности подсчитанных голосов.

Пусть бюллетень будет содержать $n$ возможных вариантов выбора.

Для удобства определим функцию $\rho:\mathbb{N}\longrightarrow\mathbb{P_+}$, которая дает $n$-ое положительное простое число.

### Построение схем RSA

Первое, с чего нужно начать, - построить организаторами стандартную схему RSA:
$(m, e)$ - открытый ключ; $(m, d)$ - закрытый ключ. Также, каждый избиратель $I_k$ строит свою личную схему RSA с открытым $(m_k, e_k)$ и закрытым $(m_k, d_k)$ ключами, которые понадобяться как для аунтентификации, так и для транспортных задач. Помимо этого, чтобы быть максимально увереным, что данные дойдут до Центра в своем первозданном виде, избирателю необходимо также выбрать такое простое $q_k$(которое называется затеняющим числом), что $\rho(q_k)\geq(n+1)$, так как первые $n$ простых чисел будут участвовать в бюллетене.

### Формирование и отравка бюллетеня

Когда все схемы построенны и значения выбраны предстоит разобраться с самим бюллетенем. Каждый $I_k$ выбирает одно или несколько натуральных чисел от $1$ до n, в зависимости от преподчитаемых вариантов ответа. Бюллетень состоит так: 

$$b_k=\begin{cases}
1, \text{воздержаться}\\
2, \text{первый кандидат}\\
3, \text{второй кандидат}\\
5, \text{третий кандидат}\\
\dots \\
\rho(n), n\text{-ый кандидат}\\
\end{cases}
$$

После выбора, избиратель шифрует по схеме RSA с открытым ключом Центра произведение всех выбранных вариантов с затеняющим числом  и передает его Центру:
$$
f_k = (q_k\prod{\rho(\omega_i)} )^e \mod m,
$$
где $\omega_i$ - $i$-ый выбранный избиратель. 

### Отправка и дешифрация бюллетеней

После процесса регистрации(Привязка к ФИО открытого ключа $(m_k, e_k)$ избирателя) и аунтентификации, описанной в предыдущем файле, избиратель отправляет уже сформированный бюллетень $f_k$ Центру. Получив все бюллетени, Центр начинает расшифровку бюллетеней:
$$
    F_k = (f_k)^d \mod m
$$
Произведение всех расшифрованных бюллетеней $E = \prod{F_k}$